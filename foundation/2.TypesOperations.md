# 类型和运算符

## 引言

在 Python 中数据以对象形式出现，对象是 Python 最基本概念。  
Python 程序可分解为模块、语句、表达式、对象：  

1. 程序由模块构成
2. 模块包含语句
3. 语句包含表达式
4. 表达式建立并处理对象

## Python 内置对象类型

| 内置对象类型 | 示例/创建                                |
| ------------ | ---------------------------------------- |
| 数字         | 123, 3.14, 1+2j                          |
| 字符串       | 'aaa', "xxxx"                            |
| 列表         | [1,2,[ 'a','b','c' ],4],list(range(10))  |
| 字典         | {'name':'sam','age':24},dict(addr='xxx') |
| 元组         | ('a','b',3),tuple('a','b')               |
| 文件         | open('/test.txt')                        |
| 集合         | {'a','b',1,2,3}, set('abcd')             |
| 其他类型     | types，None，Booleans                    |
| 编程单元类型 | 函数，模块，类                           |

### 数字

Python 中包含：整数、浮点数、布尔值、复数、分数等等类型  
运算符：+, -, *, /,//, **  
二进制 `0b11`,八进制 `0o11`,十六进制 `0x11`

```pytyon
>>> 1+1
2
>>> 3-2
1
>>> 2*3
6
>>> 5/3
1.6666666666666667
>>> 5//3
1
>>> 2**3
8
>>>
```

### 字符串

字符串可以看做是单个字符的序列(sequence)，单引号、双引号、三引号定义  
具有以下特性：

* 支持序列操作(索引、分片...)
* 不可变性(创建后不可原处改变)
* 类型的特定方法(find,replace,...)
* raw字符,抑制转义 `str=r'D:\test.txt'`

```python
>>> str='qwet123'
>>> str[1]
'w'
>>> str[3:]
't123'
>>> str.find('t')
3
>>>
```

> 类型的特定方法可通过 `dir()` 和 `help()` 查看
>
> ```python
>>> dir(str)
> ...
>>>
>>> help(str.replace)
> ...
>```

* 字符串格式化表达

`'...%s...' % (values)`  
格式化语法结构：`%[(keyname)][flags][width][.precision]typecode`

> Provide a key name for indexing the dictionary used on the right side of the expression  
List flags that specify things like left justification (−), numeric sign (+), a blank before positive numbers and a – for negatives (a space), and zero fills (0)  
Give a total minimum field width for the substituted text  
Set the number of digits (precision) to display after a decimal point for floatingpoint numbers

```python
>>> x=1234
>>> res='%d,%-6d,%06d,%.2f'%(x,x,x,x)
>>> res
'1234,1234  ,001234,1234.00'
>>> 
>>> '%(qty)d more %(food)s' % {'qty': 1, 'food': 'spam'}
'1 more spam'
>>> # Template with substitution targets
>>> reply = """
Greetings...
Hello %(name)s!
Your age is %(age)s
"""
>>> values = {'name': 'Bob', 'age': 40} # Build up values to substitute
>>> print(reply % values) # Perform substitutions
Greetings...
Hello Bob!
Your age is 40
```

| Code | Meaning                                  |
| ---- | ---------------------------------------- |
| s    | String (or any object’s str(X) string)   |
| r    | Same as s, but uses repr, not str        |
| c    | Character (int or str)                   |
| d    | Decimal (base-10 integer)                |
| i    | Integer                                  |
| u    | Same as d (obsolete: no longer unsigned) |
| o    | Octal integer (base 8)                   |
| x    | Hex integer (base 16)                    |
| X    | Same as x, but with uppercase letters    |
| e    | Floating point with exponent, lowercase  |
| E    | Same as e, but uses uppercase letters    |
| f    | Floating-point decimal                   |
| F    | Same as f, but uses uppercase letters    |
| g    | Floating-point e or f                    |
| G    | Floating-point E or F                    |
| %    | Literal % (coded as %%)                  |

* 字符串 format 方法调用

 format 语法：`'...{}...'.format(values)` 支持位置，键值，混合参数

```python
>>> template = '{0}, {1} and {2}' # By position
>>> template.format('spam', 'ham', 'eggs')
'spam, ham and eggs'
>>> template = '{motto}, {pork} and {food}' # By keyword
>>> template.format(motto='spam', pork='ham', food='eggs')
'spam, ham and eggs'
>>> template = '{motto}, {0} and {food}' # By both
>>> template.format('ham', motto='spam', food='eggs')
'spam, ham and eggs'
>>> template = '{}, {} and {}' # By relative position
>>> template.format('spam', 'ham', 'eggs') # New in 3.1 and 2.7
'spam, ham and eggs
```

格式化扩展语法 `{fieldname component !conversionflag :formatspec}`

>• fieldname is an optional number or keyword identifying an argument, which may
be omitted to use relative argument numbering in 2.7, 3.1, and later.  
• component is a string of zero or more “.name” or “[index]” references used to fetch
attributes and indexed values of the argument, which may be omitted to use the
whole argument value.  
• conversionflag starts with a ! if present, which is followed by r, s, or a to call repr,
str, or ascii built-in functions on the value, respectively.  
• formatspec starts with a : if present, which is followed by text that specifies how
the value should be presented, including details such as field width, alignment,
padding, decimal precision, and so on, and ends with an optional data type code.  

**formatspec**: `[[fill]align][sign][#][0][width][,][.precision][typecode]`

```python
>>> '{0.platform:>10} = {1[kind]:<10}'.format(sys, dict(kind='laptop'))
'     win32 = laptop    '
>>> '{0:e}, {1:.3e}, {2:g}'.format(3.14159, 3.14159, 3.14159)
'3.141590e+00, 3.142e+00, 3.14159'
>>> '{0:f}, {1:.2f}, {2:06.2f}'.format(3.14159, 3.14159, 3.14159)
'3.141590, 3.14, 003.14'
```

### 列表

列表是任意类型对象的有序序列(sequence)，具有以下特性：

* 支持序列操作(索引、分片...)
* 类型的特定方法(append,pop,sort,...)
* 列表解析 `[x**2 for x in range(10)]`

```python
>>> L=[1,2,3,4,5]
>>> L[-1]
5
>>> L.append(8)
>>> L
[1, 2, 3, 4, 5, 8]
>>> [x**2 for x in L]
[1, 4, 9, 16, 25, 64]
>>>
```

### 字典

字典是一种 key:value 映射的数据对象  

* 映射操作

```python
>>> d={'name':'sam','age':20,'addr':'xxxxxx'}
>>> print(d['name'])
sam
>>> d['age']+=1
>>> d['age']
21
>>> d['sex']='male'
>>> d
{'name': 'sam', 'age': 21, 'addr': 'xxxxxx', 'sex': 'male'}
```

> 重访嵌套： value 可以是 Python 支持的数据对象  
> 例如：
>  
> ```python
> {'name':{'first':'jane','last':'smiths'}}
> >>> N['name']['first']
>'jane'
>```

* 类型的特定方法(keys,values,items,...)

### 元组

元组可以看做是不可改变的列表(list)

```python
>>> T=(1,2,3,4,5,[3,2,4])
>>> T[3]
4
>>> T.count(4)
1
>>> T+('a','b')
(1, 2, 3, 4, 5, [3, 2, 4], 'a', 'b')
```

### 文件

```python
>>> f=open(test.txt,'w') # 'w'is  write
>>> f.write('Hell Word\n')
>>> f=open(read.txt) # 'r' (read) is the default processing mode
>>> f.read()
>>> f.close()
>>> for line in open('data.txt'):
...     print(line)
```

### 其他核心类型

* 集合 `{'a','b','c'}` `set('snap')`

```python
>>> s1={'a','b','c'}
>>> s2=set('snap')
>>> s2
{'a', 'n', 'p', 's'}
>>> s1
{'b', 'c', 'a'}
>>> s1&s2 # intersect
{'a'}
>>> s1|s2 # union
{'b', 'c', 's', 'n', 'p', 'a'}
>>> s1-s2 # difference
{'b', 'c'}
```

* 小数 Decimal
* 分数 Fraction
* 布尔值 Booleans
* None

### 运算符

| Operators                                    | Description                                                            |
| -------------------------------------------- | ---------------------------------------------------------------------- |
| yield x                                      | Generator function send protocol                                       |
| lambda                                       | args: expression Anonymous function generation                         |
| x if y else z                                | Ternary selection (x is evaluated only if y is true)                   |
| x or y                                       | Logical OR (y is evaluated only if x is false)                         |
| x and y                                      | Logical AND (y is evaluated only if x is true)                         |
| not x                                        | Logical negation                                                       |
| x in y, x not in y                           | Membership (iterables, sets)                                           |
| x is y, x is not y                           | Object identity tests                                                  |
| x < y, x <= y, x > y, x >= y, x == y, x != y | Magnitude comparison, set subset and superset;Value equality operators |
| x \| y                                       | Bitwise OR, set union                                                  |
| x ^ y                                        | Bitwise XOR, set symmetric difference                                  |
| x & y                                        | Bitwise AND, set intersection                                          |
| x << y, x >> y                               | Shift x left or right by y bits                                        |
| x + y, x – y                                 | Addition, concatenation;Subtraction, set difference                    |
| x * y, x % y, x / y, x // y                  | Multiplication, repetition; Remainder, format;Division: true and floor |
| −x, +x                                       | Negation, identity                                                     |
| ~x                                           | Bitwise NOT (inversion)                                                |
| x ** y                                       | Power (exponentiation)                                                 |
| x[i]                                         | Indexing (sequence, mapping, others)                                   |
| x[i:j:k]                                     | Slicing                                                                |
| x(...)                                       | Call (function, method, class, other callable)                         |
| x.attr                                       | Attribute reference                                                    |
| (...)                                        | Tuple, expression, generator expression                                |
| [...]                                        | List, list comprehension                                               |
| {...}                                        | Dictionary, set, set and dictionary comprehensions                     |

### 动态类型

类型属于对象，而不是变量  
共享引用(可变、不可变类型)  
不可变类型：数字、字符串、元组、不可变集合(frozensets)  
可变类型：列表、字典、可变集合(sets)